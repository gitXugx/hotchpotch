# Eureka 注册中心
> 在多服务的情况下，进行服务间调用必须知道服务提供者的详细信息才能进行调用，在之前是由提供者或者消费者自己来维护服务地址信息等，负载均衡的实现也是通过ngin来进行。


## 未出注册中心的实现

1. `Nginx` 只能维护服务提供方的 `ip:port` 和负载均衡，在横向扩展的时候需要修改 `Nginx`配置文件，重新加载才能进行达到新加的服务被消费
2. 也可以通过 `DNS` 来进行达到负载和横向扩展的效果，消费方只需要知道提供方的域名即可，但是当服务方扩展的时候，只需要在内网 `dns` 中更新解析列表即可，但是一般刷新 `dns` 生效大概需要5分钟左右

这两种方式看起来都可行，但是在服务特别多的时候，不能有效的统计有哪些服务，有多少可以提供服务的机器，每次去横向扩展的时候还需要从新修改配置(虽然可以用脚本实现),但是还是不够优雅。



## 注册中心

### 功能

1. 服务注册
2. 服务下线
3. 服务剔除
4. 服务续约(长连接的情况下不需要)
5. 管理页面

**服务注册:** 当有服务上线时，首先需要发送信息给注册中心，登记该服务信息，以给其他消费方获取

**服务下线:** 当有必要时需要手动下线服务，例如机器检查，网络问题

**服务剔除:** 是在服务宕机，假死的情况下，注册中心能自动将服务删除

**服务续约:** 在短连接的情况下检查服务是否宕机的一种方式，长连接的情况下，连接断开既重试后连接不上，则从服务列表剔除



### 服务发现组件

下面是常见的注册中心

|名称|AP/CP|语言|依赖|
|:----:|:-----:|:----:|:---:|
|Zookeeper|CP|java|JVM|
|Etcd|CP|go|-|
|Consul|CP|go|-|
|Eureka|AP|java|JVM|

CAP理论:
- Consistency: 数据一致性，数据存在多个副本的情况下，由于网络、机器故障软件等问题导致写入的副本不一致，存在冲突。一致性是保证多个副本的数据一致。
- Availability: 可用性，在任何时候对集群进行读写操作，都能在一定的时间内响应
- Partition Tolerance: 分区容忍性，即发生通信故障时，集群被分割，依然可以对外提供服务

























