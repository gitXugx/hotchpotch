# ribbon负载均衡
> 负载均衡是让服务能横向扩展的一个重要组件。而ribbon实现了多种负载均衡策略


## 负载均衡的策略

1. 随机策略
2. 轮询策略
3. 重试策略，如果调用服务不成功，则会选择其他服务调用
4. 最低并发策略，选择其中并发最小的服务进行请求
5. 可过滤策略
6. 响应时间加权策略

上面大部分常使用的是前3中策略

**策略配置**

1. 策略支持java注解方式

java注解方式可以注册 IRule 为 `bean`，如果不配置的话是轮询，也可以单独使用注解方式去配置个别服务，通过`@clientRibbbon`


2. 配置文件方式

在yml文件中 <service-name>.ribbon.*  `*` 是指定负载策略

**ribbon的超时和重试**
一般ribbon会配置超时时间和重试次数，但是hystrix的超时时间需要大于ribbon的超时时间，因为如果在ribbon进行重试的时候，如果hystrix超时了，就会导致后续的重试机制无效。

ribbon客户端负载均衡的时候默认是懒加载，如果在第一次请求的时候，可能会造成hystrix超时。可以通过配置使ribbon饿加载，减少这种情况的发生，也可以指定部分客户端饿加载


















