# 为什么使用redis

## reids是什么？
Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统。它有3个用途

1. 数据库: 可以作为数据来使用，一般情况下并不会当做数据库来使用，因为redis的数据是基于内存，宕机和内存满后都会造成数据的丢失
2. 缓存: 作为缓存来提高系统性能和应对高并发。缓存数据可以丢失，可以说很适合做缓存
3. 消息中间件: redis提供发布订阅模式，可用作注册中心，redis的哨兵模式对哨兵发布配置更新消息，使redis去更新配置文件，如果想做简单发布订阅是可以的，但是专业的东西还是由专业的mq来做比较合适。

了解完redis是什么，可以看出redis最适合做的是缓存。


## 为什么需要缓存?
在操作系统中，存储有内存和磁盘两种方式。
1. 磁盘： 磁盘存储资源便宜，速度比较慢，因为cpu处理数据需要先把数据读取到操作系统内核，然后在从操作系统内核复制到用户内存中cpu再获取对应的数据进行处理
2. 内存: 资源相对来说比较昂贵，但是速度比磁盘的速度快很多，cpu是直接从内存中取

那么缓存就是把磁盘或者其他地方获取数据，存放到内存中，当cpu需要的时候可以直接从内存中读取而不是先从磁盘读取到操作系统内存，再从操作系统内核复制到用户的内存中。

**说白了就是缓存被CPU拿到数据的速度 快!**

1. **性能优化**:
在系统中很多时候都是从磁盘中获取通过网络去去获取数据，这个时候网络和磁盘读取可能速度比较慢，可以把不经常变化并且访问量大的数据放入到缓存中。进而优化系统的速度。

<div align="center"> <img src="https://github.com/gitXugx/doc-images/blob/master/images/redis/redis%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.jpg"  /> </div><br>


系统接收到请求先从缓存中拿，获取不到再到数据中拿，在个人信息处理完的时候，在存入缓存中去，当用户再次访问的时候，直接从缓存中拿，然后直接返回，请求时间可能也就redis的几毫秒。

2. **高并发:**
当系统在某一个时间点，同时有大量用户进行访问，且超过了数据的的承受能力，那么可以先把读出的数据放入到缓存中，使数据库接受的请求达到数据库可承受的范围内。


<div align="center"> <img src="https://github.com/gitXugx/doc-images/blob/master/images/redis/redis%E9%AB%98%E5%B9%B6%E5%8F%91%E6%94%AF%E6%8C%81.jpg"  /> </div><br>

上面图中，如果没有缓存的情况下可能导致数据资源耗尽，而导致系统不能对外提供服务。


## 为什么使用redis

1. 如果大量使用应用内部内存会导致应用程序内存溢出。
2. 内部内存无法做到分布式缓存，即使做到付出的代价也是很昂贵的
3. 如果大量数据需要缓存，使用外部缓存是最合理的

mamecache和redis都是外部缓存，支持集群。

mamecache和redis选择redis的主要原因：
 
 1. `redis` 具有持久化功能，在某些场景下具有绝对优势，缓存雪崩，可以及时恢复缓存中的数据，来使其快速恢复服务
 2. `redis` 支持多种数据结构，而 `memcache` 只支持k/v数据，使 `redis` 具有更多的业务场景
 

## redis有哪些功能

主要使用的: 

1. 高可用: 支持主从模式，也有官方的cluster模式
2. 不仅支持k/v数据，还支持list、set、zset、hash、订阅发布
3. 支持AOF和RDB两种持久化方式
4. 支持事务操作


















